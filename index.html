<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<title>Skynox Weather & AQI</title>

<style>
*{box-sizing:border-box;font-family:system-ui;margin:0;padding:0}
body{
  min-height:100svh;
  display:flex;
  justify-content:center;
  padding:14px;
  background:linear-gradient(135deg,#667eea,#764ba2);
}
body.dark{background:#121212}
body.amoled{background:#000}

.app{
  width:100%;
  max-width:390px;
  padding:16px;
  border-radius:24px;
  background:rgba(255,255,255,.18);
  backdrop-filter:blur(18px);
  border:1px solid rgba(255,255,255,.25);
}

.card{
  background:rgba(255,255,255,.25);
  padding:14px;
  border-radius:18px;
  margin-bottom:14px;
}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  font-size:14px;
}

input,button{
  width:100%;
  padding:12px;
  border-radius:14px;
  border:none;
  margin-bottom:10px;
}

canvas{width:100%;height:120px;margin-top:10px}
.badge{padding:6px 12px;border-radius:999px;font-weight:600;display:inline-block}
footer{text-align:center;font-size:12px;opacity:.7}
</style>
</head>

<body>
<div class="app">

<h2>üå¶ Skynox</h2>

<input id="cityInput" placeholder="Search city">
<button id="searchBtn">Search</button>
<button id="locBtn">üìç Use My Location</button>

<h3 id="location">--</h3>
<h1 id="temp">--¬∞</h1>
<small id="updated">--</small>

<!-- CURRENT CONDITIONS -->
<div class="card">
<h4>üå° Current Conditions</h4>
<div class="grid">
<div id="feels">Feels like --</div>
<div id="humidity">Humidity --</div>
<div id="wind">Wind --</div>
<div id="direction">Direction --</div>
<div id="pressure">Pressure --</div>
<div id="visibility">Visibility --</div>
<div id="cloud">Cloud cover --</div>
<div id="uv">UV Index --</div>
</div>
</div>

<!-- AIR QUALITY -->
<div class="card">
<h4>üå´ Air Quality</h4>
<div id="aqiBadge" class="badge">--</div>
<p id="aqiText"></p>

<div class="grid">
<div id="pm25">PM2.5 --</div>
<div id="pm10">PM10 --</div>
<div id="co">CO --</div>
<div id="no2">NO‚ÇÇ --</div>
<div id="so2">SO‚ÇÇ --</div>
<div id="o3">O‚ÇÉ --</div>
</div>

<canvas id="aqiChart"></canvas>
<p id="maskTip"></p>
</div>

<footer>¬© Manik Roy 2025. All Rights Reserved.</footer>
</div>

<script>
const $=id=>document.getElementById(id);

/* AQI */
function pm25ToAQI(pm){
const bp=[[0,12,0,50],[12.1,35.4,51,100],[35.5,55.4,101,150],[55.5,150.4,151,200],[150.5,250.4,201,300],[250.5,500,301,500]];
for(const[bL,bH,aL,aH]of bp)if(pm>=bL&&pm<=bH)return Math.round(((aH-aL)/(bH-bL))*(pm-bL)+aL);
return 500;
}
function aqiInfo(a){
if(a<=50)return["Good","#2ecc71","Air quality is good"];
if(a<=100)return["Moderate","#f1c40f","Sensitive groups be cautious"];
if(a<=150)return["Unhealthy","#e67e22","Reduce outdoor activity"];
return["Hazardous","#e53935","Avoid outdoor exposure"];
}
function drawAQI(arr,color){
const c=$("aqiChart"),ctx=c.getContext("2d");
c.width=c.offsetWidth;c.height=120;
ctx.clearRect(0,0,c.width,c.height);
const max=Math.max(...arr);
arr.forEach((v,i)=>{
const h=(v/max)*c.height;
ctx.fillStyle=color;
ctx.fillRect(i*(c.width/arr.length),c.height-h,c.width/arr.length-2,h);
});
}

async function loadWeather(lat,lon,name){
const w=await fetch(
`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,apparent_temperature,relativehumidity_2m,windspeed_10m,winddirection_10m,cloudcover,visibility,surface_pressure,uv_index&timezone=auto`
).then(r=>r.json());

const a=await fetch(
`https://air-quality-api.open-meteo.com/v1/air-quality?latitude=${lat}&longitude=${lon}&hourly=pm2_5,pm10,carbon_monoxide,nitrogen_dioxide,sulphur_dioxide,ozone&timezone=auto`
).then(r=>r.json());

const idx=w.hourly.time.indexOf(w.current_weather.time);

$("location").textContent=name;
$("temp").textContent=Math.round(w.current_weather.temperature)+"¬∞C";
$("updated").textContent="Updated: "+new Date().toLocaleTimeString();

$("feels").textContent="Feels like "+Math.round(w.hourly.apparent_temperature[idx])+"¬∞C";
$("humidity").textContent="Humidity "+w.hourly.relativehumidity_2m[idx]+"%";
$("wind").textContent="Wind "+w.hourly.windspeed_10m[idx]+" km/h";
$("direction").textContent="Direction "+w.hourly.winddirection_10m[idx]+"¬∞";
$("pressure").textContent="Pressure "+Math.round(w.hourly.surface_pressure[idx])+" hPa";
$("visibility").textContent="Visibility "+(w.hourly.visibility[idx]/1000).toFixed(1)+" km";
$("cloud").textContent="Cloud cover "+w.hourly.cloudcover[idx]+"%";
$("uv").textContent="UV Index "+(w.hourly.uv_index[idx]??"N/A");

const pm=a.hourly.pm2_5[idx]??0;
const aqi=pm25ToAQI(pm);
const [label,color,text]=aqiInfo(aqi);

$("aqiBadge").textContent=`AQI ${aqi} ¬∑ ${label}`;
$("aqiBadge").style.background=color;
$("aqiText").textContent=text;

$("pm25").textContent="PM2.5 "+pm;
$("pm10").textContent="PM10 "+(a.hourly.pm10[idx]??"N/A");
$("co").textContent="CO "+(a.hourly.carbon_monoxide[idx]??"N/A");
$("no2").textContent="NO‚ÇÇ "+(a.hourly.nitrogen_dioxide[idx]??"N/A");
$("so2").textContent="SO‚ÇÇ "+(a.hourly.sulphur_dioxide[idx]??"N/A");
$("o3").textContent="O‚ÇÉ "+(a.hourly.ozone[idx]??"N/A");

$("maskTip").textContent=aqi<=50?"üòå No mask":aqi<=100?"üòê Sensitive mask":"üò∑ N95 recommended";

drawAQI(a.hourly.pm2_5.slice(idx,idx+24).map(pm25ToAQI),color);
}

/* Controls */
$("searchBtn").onclick=async()=>{
const q=$("cityInput").value.trim();
if(!q)return;
const r=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${q}&count=1`).then(r=>r.json());
if(r.results)loadWeather(r.results[0].latitude,r.results[0].longitude,r.results[0].name);
};
$("locBtn").onclick=()=>navigator.geolocation.getCurrentPosition(p=>{
loadWeather(p.coords.latitude,p.coords.longitude,"Current Location");
});

loadWeather(28.61,77.23,"Delhi, India");
</script>
</body>
</html>
